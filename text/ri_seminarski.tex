% !TEX encoding = UTF-8 Unicode
\documentclass[a4paper]{article}
\usepackage{geometry}
 \geometry{
 a4paper,
 total={150mm,240mm},
 left=30mm,
 top=30mm,
 }

\usepackage{color}
\usepackage{url}
\usepackage[T2A]{fontenc} % enable Cyrillic fonts
\usepackage[utf8]{inputenc} % make weird characters work
\usepackage{graphicx}
\usepackage[]{algorithm2e}

\usepackage[english,serbian]{babel}
%\usepackage[english,serbianc]{babel} %ukljuciti babel sa ovim opcijama, umesto gornjim, ukoliko se koristi cirilica

\usepackage[unicode]{hyperref}
\hypersetup{colorlinks,citecolor=green,filecolor=green,linkcolor=blue,urlcolor=blue}

\usepackage{listings}

%\newtheorem{primer}{ĞŸÑ€Ğ¸Ğ¼ĞµÑ€}[section] %Ä‡iriliÄni primer
\newtheorem{primer}{Primer}[section]

\definecolor{mygreen}{rgb}{0,0.6,0}
\definecolor{mygray}{rgb}{0.5,0.5,0.5}
\definecolor{mymauve}{rgb}{0.58,0,0.82}

\lstset{ 
  backgroundcolor=\color{white},   % choose the background color; you must add \usepackage{color} or \usepackage{xcolor}; should come as last argument
  basicstyle=\scriptsize\ttfamily,        % the size of the fonts that are used for the code
  breakatwhitespace=false,         % sets if automatic breaks should only happen at whitespace
  breaklines=true,                 % sets automatic line breaking
  captionpos=b,                    % sets the caption-position to bottom
  commentstyle=\color{mygreen},    % comment style
  deletekeywords={...},            % if you want to delete keywords from the given language
  escapeinside={\%*}{*)},          % if you want to add LaTeX within your code
  extendedchars=true,              % lets you use non-ASCII characters; for 8-bits encodings only, does not work with UTF-8
  firstnumber=1000,                % start line enumeration with line 1000
  frame=single,	                   % adds a frame around the code
  keepspaces=true,                 % keeps spaces in text, useful for keeping indentation of code (possibly needs columns=flexible)
  keywordstyle=\color{blue},       % keyword style
  language=Python,                 % the language of the code
  morekeywords={*,...},            % if you want to add more keywords to the set
  numbers=left,                    % where to put the line-numbers; possible values are (none, left, right)
  numbersep=5pt,                   % how far the line-numbers are from the code
  numberstyle=\tiny\color{mygray}, % the style that is used for the line-numbers
  rulecolor=\color{black},         % if not set, the frame-color may be changed on line-breaks within not-black text (e.g. comments (green here))
  showspaces=false,                % show spaces everywhere adding particular underscores; it overrides 'showstringspaces'
  showstringspaces=false,          % underline spaces within strings only
  showtabs=false,                  % show tabs within strings adding particular underscores
  stepnumber=2,                    % the step between two line-numbers. If it's 1, each line will be numbered
  stringstyle=\color{mymauve},     % string literal style
  tabsize=2,	                   % sets default tabsize to 2 spaces
  title=\lstname                   % show the filename of files included with \lstinputlisting; also try caption instead of title
}

\begin{document}

\title{PodeÅ¡avanje teÅ¾ina neuronske mreÅ¾e upotrebom optimizacionog algoritma\\ \small{Seminarski rad u okviru kursa\\RaÄunarska inteligencija\\ MatematiÄki fakultet}}

\author{Nikola StameniÄ‡, Lea PetkoviÄ‡\\ mi16177@alas.matf.bg.ac.rs, mi16163@alas.matf.bg.ac.rs}

%\date{9.~april 2015.}

\maketitle

\abstract{
U ovom tekstu je ukratko prikazana osnovna forma seminarskog rada. 

\tableofcontents

\newpage

\section{Uvod}
\label{sec:uvod}

Ovde ide neki uvod

\section{Neuronske mreÅ¾e}
\label{neuronskemreze}

Neuronska mreÅ¾a (eng. \emph{Artificial Neural Networks, ANN}) je sistem koji vrÅ¡i mapiranje izmeÄ‘u ulaza i izlaza problema. Neuronske mreÅ¾e zapravo predstavljaju parametrizovanu reprezentaciju koja se moÅ¾e koristiti za aproksimaciju raznih funkcija \cite{hindawi}. MatematiÄkom optimizacijom nekog od kriterijuma kvaliteta vrÅ¡i se pronalaÅ¾enje odgovarajuÄ‡ih parametara. 

Neuronske mreÅ¾e uÄe informacije kroz proces treniranja u nekoliko iteracija. Kada je proces uÄenja zavrÅ¡en, neuronska mreÅ¾a je spremna i sposobna da klasifikuje nove informacije, predvidi ponaÅ¡anje, ili aproksimira nelinearnu funkciju problema. Njena struktura sastoji se od skupa neurona, predstavljenih
funkcijama, koji su meÄ‘usobno povezani sa ostalim neuronim organizovanim u slojevima. 

Struktura neuronske mreÅ¾e se razlikuje po broju slojeva. Prvi sloj jeste ulazni sloj, poslednji sloj jeste izlazni, a svi slojevi izmeÄ‘u se nazivaju skrivenim
slojevima. Slojevi su meÄ‘usobno potpuno povezani. Slojevi komuniciraju zahvaljujuÄ‡i tome Å¡to je izlaz svakog neurona, iz prethodnog sloja, povezan sa
ulazima svih neurona iz narednog sloja. JaÄina veza kojom su neuroni meÄ‘usobno povezani se naziva teÅ¾inski faktor (eng. \emph{weight}). NajÄeÅ¡Ä‡e ima
3 sloja.

Postoje razliÄite vrste neuronskih mreÅ¾a. Mozemo ih klasifikovati prema: broju slojeva (jednoslojne i viÅ¡eslojne), vrsti veza izmeÄ‘u neurona, smeru
prostiranja informacija (neuronske mreÅ¾e sa propagacijom unapred ili unazad) \cite{website}, vrsti podataka itd. 

Njihove primene su mnogobrojne, obzirom da predstavljaju najÄeÅ¡Ä‡e primenjivanu metodu maÅ¡inskog uÄenja. Neke od primena su: kategorizacija teksta,
medicinska dijagnostika, prepoznavanje objekata na slikama, autonomna voÅ¾nja, igranje igara poput igara na tabli ili video igara, maÅ¡insko prevoÄ‘enje
prirodnih jezika, prepoznavanje rukom pisanih tekstova itd. 

\subsection{Keras Pajton biblioteka}
\label{subsec:keras}

Keras je biblioteka za neuronske mreÅ¾e, napisana u Pajtonu. Keras radi na platformi za maÅ¡insko uÄenje  \textit{TensorFlow}. Razvijena je sa ciljem da omoguÄ‡i brzo eksperimentisanje sa neuronskim mreÅ¾ama \cite{keraswebsite}, da bude razumljiva, modularna i proÅ¡iriva.

Pored, veÄ‡ pomenute, \textit{TensorFlow} platforme, ova biblioteka radi i na: \textit{Microsoft Cognitive Toolkit, R, Theano, ili PlaidML} platformama. Nastala je kao deo istraÅ¾ivanja u okviru projekta ONEIROS (eng. \emph{Open-ended Neuro-Electronic Intelligent Robot Operating System}), a njen autor i odrÅ¾avaoc je gugl inÅ¾enjer -  FranÃ§ois Chollet.
% \begin{verbatim}
% Å¡ÄÄ‡Å¾Ä‘
% \end{verbatim}

\section{Optimizacija rojem Äestica}
\label{subsec:pso}
U ovoj sekcije biÄ‡e objaÅ¡njen sam algoritam optimizacije rojem Äestica. NajviÅ¡e vremena biÄ‡e posveÄ‡eno originalnom algoritmu PSO, a kao i drugoj generaciji algoritma PSO (eng. \textit{The Secong Generation of PSO}), kao i novom modelu algoritma PSO 
(eng. \textit{A New Model of PSO}).


\subsection{Originalni algoritam PSO}
\label{subsec:opso}
Algoritam PSO (eng. \textit{Particle Swarm Optimization}) je metod za optimizaciju neprekidne nelinearne funkcije, koji je predloÅ¾io Eberhart.
Sam algoritam je inspirisan posmatranjem socijalnog i kolektivnog ponaÅ¡anja u kretanju jata ptica pri potrazi za hranom ili preÅ¾ivaljavanjem.
PSO je nadahnut kretanjem najboljeg Älana populacije i njegovog iskustva. Metafora govori da se skup reÅ¡enja kreÄ‡e prostorom pretrage sa ciljem da naÄ‘e Å¡to bolju poziciju, reÅ¡enje \cite{hindawi}.
\\
Populacijom se smatra grupa Äestica \textit{i} gde svaka predstavlja poziciju \textbf{\textbf{$x_i \in R^D$, i = 1,...,M}} u viÅ¡edimenzionom prostoru.
ÄŒestice se evaluiraju u posebnoj funkciji optimizacije, kako bi se odredila njihova prilagoÄ‘enost i saÄuvala najbolja vrednost. Svaka Äestica se kreÄ‡e po
prostoru pretrage u zavisnosti od funkcije brzine \textbf{$v_i$} koja u obzir uzima globalno najbolju poziciju u populaciji ($p_g \in R^D$ - socijalna
komponenta) kao i najbolju poziciju date Äestice ($p_g \in R^D$ - kognitivna komponenta). ÄŒestice Ä‡e se kretati u svakoj iteraciji na drugu poziciju,
dok ne dostignu optimalnu poziciju. U svakom momentu \textit{t}, brzina Äestice \textit{i} se aÅ¾urira koristeÄ‡i: 
\begin{center}
\textbf\textit{$v_i(t+1) = \omega v_i(t) + c_1 r_1(p_i (t) - x_i (t)) + c_2 r_2 (p_g (t) - x_i (t))$}
\end{center}
gde je $\omega$ inertna teÅ¾ina i obiÄno je postavljena da varira linearno od 1 do 0 tokom iteracije, $c_1$ i $c_2$ su koeficijenti ubrzanja, $r_1$ i $r_2$
su sluÄajni brojevi iz uniformne (0,1) raspodele. Ubrzanje \textbf{$v_i$} je ograniÄeno izmeÄ‘u [$v_min, v_max$]. AÅ¾uriranjem ubrzanja na ovaj 
naÄin dozvoljavamo jedinki $i$ da traÅ¾i najbolju poziciju \textbf{$p_i(t)$}, dok se najbolje globalno reÅ¡enje raÄuna:\cite{hindawi}
\begin{center}
\textbf\textit{$x_i(t+1) = x_i(t) + v_i(t+1)$}
\end{center} 
% Optimizacija rojem Äestica se moÅ¾e prikazati sledeÄ‡im pseudokodom:

%Za sva reÅ¡enja (Äestice)  ğ‘–  iz skupa reÅ¡enja (roja)  ğ‘‹ :

%Izabrati koordinate vektora  ğ‘¥ğ‘–  uniformno iz intervala  (ğ‘™,ğ‘¢) 
%ğ‘ğ‘–=ğ‘¥ğ‘– 
%Ako je  ğ‘“(ğ‘¥ğ‘–)<ğ‘“(ğ‘”)  tada  ğ‘”=ğ‘¥ğ‘– 
%OznaÄiti koordinate vektora  ğ‘£ğ‘–  da su jednaki nuli ili uniformno iz %intervala  (âˆ’|ğ‘¢âˆ’ğ‘™|,|ğ‘¢âˆ’ğ‘™|) 
%Dok nije ispunjen kriterijum zaustavljanja:

%Za sve Äestice  ğ‘–  iz roja  ğ‘‹ :
%Izabrati brojeve  ğ‘Ÿğ‘”  i  ğ‘Ÿğ‘  uniformno iz intervala  (0,1) 
%ğ‘£ğ‘–=ğ‘ğ‘£ğ‘£ğ‘–+ğ‘ğ‘ğ‘Ÿğ‘(ğ‘ğ‘–âˆ’ğ‘¥ğ‘–)+ğ‘ğ‘”ğ‘Ÿğ‘”(ğ‘”âˆ’ğ‘¥ğ‘–) 
%ğ‘¥ğ‘–=ğ‘¥ğ‘–+ğ‘£ğ‘– 
%Ako je  ğ‘“(ğ‘¥ğ‘–)<ğ‘“(ğ‘ğ‘–)  tada  ğ‘ğ‘–=ğ‘¥ğ‘– 
%Ako je  ğ‘“(ğ‘¥ğ‘–)<ğ‘“(ğ‘”)  tada  ğ‘”=ğ‘¥ğ‘– 
%ReÅ¡enje je vektor  ğ‘” , a vrednost reÅ¡enja broj  ğ‘“(ğ‘”)


\subsection{Druga generacija PSO algoritma}
\label{subsec:sgpso}
Druga generacija PSO algoritma je unapreÄ‘enje originalnog PSO algoritma, koja u obzir uzima tri aspekta: lokalni optimum svih jedinki,
globalno najbolje reÅ¡enje, i novi koncept - geometrijski centar optimalne populacije. Autor knjige \textit{"{}Second Generation Particle Swarm Optimization"} objaÅ¡njava da ptice odrÅ¾avaju 
odreÄ‘enu distancu izmeÄ‘u centra jata (hrane). Jata ptica uvek ostaju u istom regionu neko vreme, tokom kojeg Ä‡e centar jata ostati
nepomeren u oÄima jedinki. Nakon toga, jato se kreÄ‡e na sledeÄ‡i region, tada sve jedinke moraju odrÅ¾ati odreÄ‘enu distancu sa centrom jata.

\subsection{Novi model PSO-a}
\label{subsec:nmpso}
Ovaj algoritam je predloÅ¾en od strane Garoa (eng. \textit{Garro}), a on ga je bazirao na osnovu ideja drugih autora koji su predlagali unapreÄ‘enje
originalnog PSO algoritma. 
Shi i Eberhart su predlagali linearno variranje inertnih teÅ¾ina kroz generacije, Å¡to je znatno unapredilo performanse originalnog PSO algoritma.
Yu je razvio strategiju da kada se kroz generacije globalno najbolje reÅ¡enje ne poboljÅ¡ava, svaka jedinka \textit{$i$} biva izabrana sa predefinisanom
verovatnoÄ‡om a zatim dodat sluÄajni Å¡um svakom vektoru brzine dimenzije $v_i$ izabrane jedinke \textit{$i$}.
Bazirano na nekim evolutivnim shemama GenetiÄkih Algoritama, nekoliko efektnih mutacija i ukrÅ¡tanja su predloÅ¾ene za PSO.

\section{PodeÅ¡avanje teÅ¾ina neuronske mreÅ¾e pomoÄ‡u optimizacije rojem Äestica}
\label{sec:podesavanjetezina}

Treniranje neuronske mreÅ¾e, odnosno podeÅ¡avanje teÅ¾ina, izvrÅ¡eno je pomoÄ‡u optimizacije rojem Äestica. 
Napravljena je troslojna neuronska mreÅ¾a (ulazni, skriveni i izlazni sloj) pomoÄ‡u Keras biblioteke u Pajtonu, pomoÄ‡u koje se reÅ¡avaju klasifikacioni problemi. Dve treÄ‡ine podataka koriÅ¡Ä‡ene su za trening podatke, a ostatak Äini test podatke. Skriveni sloj sadrÅ¾i 100 jedinica/Ävorova, dok je broj izlaza ekvivalentan broju razliÄitih klasa u odgovarajuÄ‡em skupu podataka. Kao metrika koriÅ¡Ä‡ena je preciznost (eng. \emph{accurancy}). 

Kao Å¡to je ranije napomenuto, ANN trenirana je pomoÄ‡u PSO algoritma. PSO koristi 30 Äestica, prolazi kroz 300 iteracija i Å¡alju se trening podaci i neuronska mreÅ¾a. TeÅ¾ine neuronske mreÅ¾e predstavljaju pozicije Äestica. Inicijalne teÅ¾ine biraju se nasumiÄno unutar intervala [-2, 2], a aÅ¾uriranje teÅ¾ina se vrÅ¡i prema formuli: {$x_i(t+1) = x_i(t) + v_i(t+1)$}, objaÅ¡njenoj u poglavlju \ref{subsec:opso}. Parametri c1, c2 i w izabrani su u odnosu na vrednosti istih tih parametara u radu \cite{hindawi}, odnosno w je 0.3, dok su c1 i c2 za 0.5 veÄ‡i, jer tako algoritam daje bolje rezultate. 

Kao funkcija cilja koriÅ¡Ä‡ena je preciznost. TakoÄ‘e, u cilju izbegavanja zaglavljivanja u lokalnom minimumu algoritam se pokreÄ‡e nekoliko puta i pozicije najgorih 5 Äestica se nasumiÄno menjaju. Najbolja Äestica je upravo ona sa najveÄ‡om preciznoÅ¡Ä‡u.

\subsection{Rezultati}
\label{rezultati}

U ovoj sekciji biÄ‡e predstavljeni eksperimentalni rezultati dobijeni nad skupovima: Iris, Breast Cancer i Wine, kao i uporeÄ‘eni sa rezultatima drugih istraÅ¾ivaÄa koji su se bavili ovom temom i koristili navedene skupove \cite{hindawi}. U nastavku sledi viÅ¡e o rezultatima na svakom od njih pojedinaÄno.

\subsubsection{Skup Iris}
\label{iris}

Ovaj skup podataka nalazi se u Pajton paketu za maÅ¡insko uÄenje: Scikit-learn. Sastoji se od 3 vrste cveta Iris - Setosa, Versicolour, Virginica. SadrÅ¾i 150 instanci i ima 5 atributa koji predstavljaju duÅ¾inu i Å¡irinu latica (eng. \emph{petal length, petal width}), duÅ¾inu ÄaÅ¡iÄnog listiÄ‡a (eng. \emph{sepal length, sepal width}) i vrstu kojoj cvet pripada (eng. \emph{species}). 


\subsubsection{Skup Breast cancer}
\label{breast}

\subsubsection{Skup Wine}
\label{wine}


\begin{figure}[h!]
\begin{center}
\includegraphics[scale=0.5]{download.png}
\end{center}
\caption{Preciznost na test podacima skupova: iris, breast cancer i wine.}
\label{fig:preciznost}
\end{figure}

\textit{Ovo poglavlje sadrÅ¾i tabele i grafike kojim uporeÄ‘ujete vaÅ¡ pristup sa drugim pristupima iz literature. PronaÄ‡i relevantne test primere (instance) I testirati predloÅ¾enu metodu (metode) na njima, ukoliko su dostupne. Ako ne moÅ¾ete da doÄ‘ete do test primera iz literature, kreirajte na osnovu opisa iz radova test primere koji su im sliÄni. Testirajte vaÅ¡e metode pod sliÄnim uslovima kao i autori iz literature. Pri demonstraciji rada metode uvek pokazati kako vaÅ¡a metoda radi na na jednostavnim test primerima koji se mogu vizualizovati. Specijalno, ako ne uporeÄ‘ujete reÅ¡enje sa drugim reÅ¡enjima, moÅ¾ete komentarisati efikasnost algoritma i procenijvati kvalitet tako Å¡to ga uporeÄ‘ujete sa drugim pristupima koje ste sami razvili (npr. algoritmom potpune pretrage, eng. brute-force u sluÄaju da radite optimizacionu tehniku). Budite objektivni i poÅ¡teni u prikazu svojih rezultata i jasno naznaÄite ako vaÅ¡ pristup nije bolji (Å¡to je vrlo verovatno) od onih koji su predloÅ¾eni u literaturi. U okviru ovog poglavlja opiÅ¡ite i eksperimentalno okruÅ¾enje u kojem ste testirali vaÅ¡ program, karakteristike hardvera, operativni sistem, kompajler, itd. }



\section{ZakljuÄak}
\label{sec:zakljucak}

Ovde piÅ¡em zakljuÄak. 


\addcontentsline{toc}{section}{Literatura}
\appendix
\bibliography{seminarski} 
\bibliographystyle{plain}

\appendix
\section{Dodatak}
Ovde piÅ¡em dodatne stvari, ukoliko za time ima potrebe.


\end{document}
